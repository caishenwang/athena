function AutoCompleteCtrl(e){function t(){var t=a.keywords;t&&e.$emit("get_complete_keywords",t),a.isPopup=!!t}var a=this;a.keywords=null,a.isPopup=!1,a.query=t,e.$on("get_auto_complete_item",function(e,t){a.keywords=t[a.key]}),a.$onInit=function(){}}function DatePickerCtrl(e,t){function a(){"range"===i.defaultDate.dateStatus?D(5,new Date(i.defaultDate.startDate),new Date(i.defaultDate.endDate)):"date"===i.defaultDate.dateStatus&&c(new Date(i.defaultDate.startDate))}function n(e){var t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate(),r=new Date(t,a,0);r=r.getDate();var l=t,o=parseInt(a)-1;0===o&&(l=parseInt(l)-1,o=12);var u=n,c=new Date(l,o,0);c=c.getDate(),u>c&&(u=c),o<10&&(o="0"+o);var D=l+"-"+o+"-"+u;return D}function r(e){var t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate(),r=new Date(t,a,0);r=r.getDate();var l=t,o=parseInt(a)+1;13===o&&(l=parseInt(l)+1,o=1);var u=n,c=new Date(l,o,0);c=c.getDate(),u>c&&(u=c),o<10&&(o="0"+o);var D=l+"-"+o+"-"+u;return D}function l(){switch(m){case t.TYPE_TODAY:case t.TYPE_DATE:s=864e5;var e=new Date(new Date(i.dateRange.startDate).getTime()-s);c(e);break;case t.TYPE_7_DAYS_AGO:s=6048e5;var a=new Date(new Date(i.dateRange.endDate).getTime()-s);u(7,a);break;case t.TYPE_30_DAYS_AGO:s=2592e6,a=new Date(new Date(i.dateRange.endDate).getTime()-s),u(30,a);break;case t.TYPE_DATE_RANGE:var r=Math.floor((i.dateRange.endDate-i.dateRange.startDate)/864e5);u(r,i.dateRange.startDate);break;case t.TYPE_LAST_MONTH:var l=new Date(n(i.dateRange.endDate));days=new Date(l.getFullYear(),l.getMonth()+1,0).getDate()-1,e=new Date(l.getFullYear(),l.getMonth(),days+1),u(days,e)}d()}function o(){switch(m){case t.TYPE_TODAY:case t.TYPE_DATE:s=864e5;var e=new Date(new Date(i.dateRange.startDate).getTime()+s);c(e);break;case t.TYPE_7_DAYS_AGO:s=6048e5;var a=new Date(new Date(i.dateRange.endDate).getTime()+s);u(7,a);break;case t.TYPE_30_DAYS_AGO:s=2592e6,a=new Date(new Date(i.dateRange.endDate).getTime()+s),u(30,a);break;case t.TYPE_DATE_RANGE:var n=Math.floor((i.dateRange.endDate-i.dateRange.startDate)/864e5);a=new Date(new Date(i.dateRange.endDate).getTime()+864e5*n),u(n,a);break;case t.TYPE_LAST_MONTH:var l=new Date(r(i.dateRange.endDate)),o=new Date(l.getFullYear(),l.getMonth()+1,0).getDate()-1;e=new Date(l.getFullYear(),l.getMonth(),o+1),u(o,e)}d()}function u(e,t){s=864e5*e,t&&(i.dateRange.endDate=t),i.dateRange.startDate=new Date(i.dateRange.endDate-s)}function c(e){i.dateRange.startDate=e,i.dateRange.endDate=e}function D(e,a,r){switch(m=e){case t.TYPE_TODAY:c(new Date);break;case t.TYPE_7_DAYS_AGO:u(7,i.nowDate);break;case t.TYPE_30_DAYS_AGO:u(30,i.nowDate);break;case t.TYPE_DATE:c(a);break;case t.TYPE_DATE_RANGE:i.dateRange.startDate=a,i.dateRange.endDate=r;var l=Math.floor((i.dateRange.endDate-i.dateRange.startDate)/864e5);u(l,i.dateRange.endDate);break;case t.TYPE_LAST_MONTH:var o=new Date(n(i.dateRange.endDate)),D=new Date(o.getFullYear(),o.getMonth()+1,0).getDate()-1,s=new Date(o.getFullYear(),o.getMonth(),D+1);u(D,s)}d()}function d(){e.$emit("date_update_timely",i.dateRange)}var i=this,s=0,m=t.TYPE_DATE_RANGE;i.nowDate=new Date,i.dateRange={startDate:null,endDate:null},i.prev=l,i.next=o,i.selectDateRange=D,a()}function dateRange(){function e(e){return e=e?new Date(e):new Date,e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}return function(t){return t.startDate==t.endDate?e(t.startDate):e(t.startDate)+" è‡³ "+e(t.endDate)}}function MenuSelector(e,t){function a(){}function n(t,a,n){n&&a?(o.selectedMenu=[t,a,n],o.isShow=!1):!n&&a&&0===a.children.length?(o.selectedMenu=[t,a],o.isShow=!1):n||a||0!==t.children.length||(o.selectedMenu=[t],o.isShow=!1),e.$emit("get_selected_menu",o.selectedMenu)}function r(){o.isShow=!o.isShow,o.menuList1=o.selectedMenu[0],o.menuList2=o.selectedMenu[1],o.menuList3=o.selectedMenu[2]}function l(e,a){var n=a.currentTarget.parentNode.className;new RegExp("level-1").test(n)&&t(function(){$(".level-2").css({"margin-top":a.currentTarget.offsetTop})}),new RegExp("level-2").test(n)&&t(function(){$(".level-3").css({"margin-top":a.currentTarget.offsetTop})})}var o=this;o.selectedMenu=[],o.isShow=!1,o.selectMenu=n,o.showSelectedMenu=r,o.hoverSelectMenu=l,a()}function menuSelector(){return function(e){if(e){if(e[2])return e[0].name+" > "+e[1].name+" > "+e[2].name;if(e[1]&&0===e[1].children.length)return e[0].name+" > "+e[1].name;if(e[0]&&0===e[0].children.length)return e[0].name}}}function AutoCompleteItemCtrl(e){function t(t){a.selectedItem=t,e.$emit("get_auto_complete_item",t),a.isPopup=!1}var a=this;a.selectResult=t,e.getTemplate=function(){return"auto-complete-"+a.type+".view.html"}}angular.module("athena",["athena.autoComplete","athena.menuSelector","athena.templates","athena.datePicker"]),angular.module("athena.templates",[]),angular.module("athena.autoComplete",[]).component("autoComplete",{templateUrl:"auto-complete.view.html",controller:"AutoCompleteCtrl",controllerAs:"complete",bindings:{key:"@",type:"@",placeholder:"@",itemList:"=",selectedItem:"="}}),angular.module("athena.autoComplete").controller("AutoCompleteCtrl",AutoCompleteCtrl),AutoCompleteCtrl.$inject=["$scope"],angular.module("athena.datePicker",[]).component("datePicker",{templateUrl:"date-picker.view.html",controller:"DatePickerCtrl",controllerAs:"date",bindings:{defaultDate:"<"}}).constant("DATE_PICKER_TYPE",{TYPE_TODAY:1,TYPE_7_DAYS_AGO:2,TYPE_30_DAYS_AGO:3,TYPE_DATE:4,TYPE_DATE_RANGE:5,TYPE_LAST_MONTH:6}),angular.module("athena.datePicker").controller("DatePickerCtrl",DatePickerCtrl),DatePickerCtrl.$inject=["$scope","DATE_PICKER_TYPE"],angular.module("athena.datePicker").filter("dateRange",dateRange),dateRange.$inject=[],angular.module("athena.menuSelector",[]).component("menuSelector",{templateUrl:"menu-selector.view.html",controller:"MenuSelector",controllerAs:"menu",bindings:{menuList:"<",placeholder:"@"}}),angular.module("athena.menuSelector").controller("MenuSelector",MenuSelector),MenuSelector.$inject=["$scope","$timeout"],angular.module("athena.menuSelector").filter("menuSelector",menuSelector),menuSelector.$inject=[],angular.module("athena.autoComplete").component("autoCompleteItem",{template:'<div ng-include="getTemplate()"></div>',controller:"AutoCompleteItemCtrl",controllerAs:"complete",bindings:{type:"<",itemList:"=",selectedItem:"=",isPopup:"="}}),angular.module("athena.autoComplete").controller("AutoCompleteItemCtrl",AutoCompleteItemCtrl),AutoCompleteItemCtrl.$inject=["$scope"];